/*
**
** The JavaScript code is generated by atscc2js
** The starting compilation time is: 2015-4-28: 22h:25m
**
*/

var statmp0

var statmp1

var statmp2

var statmp3

function
__patsfun_10__closurerize(env0)
{
  return [function(cenv) { return __patsfun_10(cenv[1]); }, env0];
}


function
__patsfun_11__closurerize(env0)
{
  return [function(cenv) { return __patsfun_11(cenv[1]); }, env0];
}


function
__patsfun_14__closurerize(env0, env1, env2, env3)
{
  return [function(cenv) { return __patsfun_14(cenv[1], cenv[2], cenv[3], cenv[4]); }, env0, env1, env2, env3];
}


function
init()
{
//
// knd = 0
//
  // __patsflab_init
  ats2jspre_ref_set_elt(statmp0, 3);
  player_init();
  return/*_void*/;
} // end-of-function


function
_057_home_057_grad3_057_gladius_057_CS520_057_hwtest_057_SpaceInvaders_057_myGame_056_sats__player_get()
{
//
// knd = 0
  var tmpret6
  var tmp7
  var tmp8
  var tmp10
  var tmp11
  var tmp13
//
  // __patsflab_player_get
  tmp8 = ats2jspre_ref_get_elt(statmp0);
  tmp7 = ats2jspre_gt_int0_int0(tmp8, 0);
  if(tmp7) {
    tmp11 = ats2jspre_ref_get_elt(statmp0);
    tmp10 = ats2jspre_sub_int0_int0(tmp11, 1);
    ats2jspre_ref_set_elt(statmp0, tmp10);
    tmp13 = ats2jspre_ref_get_elt(statmp0);
    update_lives(tmp13);
    tmpret6 = [1];
  } else {
    gameover();
    tmpret6 = null;
  } // endif
  return tmpret6;
} // end-of-function


function
enemy_get(arg0)
{
//
// knd = 0
  var tmpret15
  var tmp17
  var tmp18
  var tmp19
  var tmp20
  var tmp22
  var tmp23
//
  // __patsflab_enemy_get
  tmp18 = ats2jspre_ref_get_elt(statmp2);
  tmp17 = ats2jspre_sub_int0_int0(tmp18, arg0);
  ats2jspre_ref_set_elt(statmp2, tmp17);
  tmp20 = ats2jspre_ref_get_elt(statmp2);
  tmp19 = ats2jspre_lte_int0_int0(tmp20, 0);
  if(tmp19) {
    tmp23 = ats2jspre_ref_get_elt(statmp2);
    tmp22 = ats2jspre_add_int0_int0(tmp23, 200);
    ats2jspre_ref_set_elt(statmp2, tmp22);
    tmpret15 = [1];
  } else {
    tmpret15 = null;
  } // endif
  return tmpret15;
} // end-of-function


function
enemy_move_get(arg0)
{
//
// knd = 0
  var tmpret24
  var tmp26
  var tmp27
  var tmp28
  var tmp29
  var tmp31
  var tmp32
//
  // __patsflab_enemy_move_get
  tmp27 = ats2jspre_ref_get_elt(statmp3);
  tmp26 = ats2jspre_sub_int0_int0(tmp27, arg0);
  ats2jspre_ref_set_elt(statmp3, tmp26);
  tmp29 = ats2jspre_ref_get_elt(statmp3);
  tmp28 = ats2jspre_lte_int0_int0(tmp29, 0);
  if(tmp28) {
    tmp32 = ats2jspre_ref_get_elt(statmp3);
    tmp31 = ats2jspre_add_int0_int0(tmp32, 10);
    ats2jspre_ref_set_elt(statmp3, tmp31);
    tmpret24 = [1];
  } else {
    tmpret24 = null;
  } // endif
  return tmpret24;
} // end-of-function


function
player_keyPress()
{
//
// knd = 0
  var tmp35
  var tmp36
  var tmp37
  var tmp39
  var tmp40
  var tmp42
  var tmp43
  var tmp44
  var tmp45
  var tmp46
//
  // __patsflab_player_keyPress
  tmp36 = check_key(37);
  tmp35 = ats2jspre_eq_int0_int0(tmp36, 1);
  if(tmp35) {
    tmp37 = ats2jspre_neg_double(20.000000000000000000);
    player_move(tmp37, 0.0);
  } else {
    // ATSINSmove_void
  } // endif
  tmp40 = check_key(39);
  tmp39 = ats2jspre_eq_int0_int0(tmp40, 1);
  if(tmp39) {
    player_move(20.000000000000000000, 0.0);
  } else {
    // ATSINSmove_void
  } // endif
  tmp43 = check_key(38);
  tmp42 = ats2jspre_eq_int0_int0(tmp43, 1);
  if(tmp42) {
    player_move(0.0, 20.000000000000000000);
  } else {
    // ATSINSmove_void
  } // endif
  tmp45 = check_key(40);
  tmp44 = ats2jspre_eq_int0_int0(tmp45, 1);
  if(tmp44) {
    tmp46 = ats2jspre_neg_double(20.000000000000000000);
    player_move(0.0, tmp46);
  } else {
    // ATSINSmove_void
  } // endif
  return/*_void*/;
} // end-of-function


function
player_move(arg0, arg1)
{
//
// knd = 0
  var tmp48
  var tmp49
  var tmp50
  var tmp51
  var tmp52
  var tmp53
  var tmp54
  var tmp55
  var tmp56
  var tmp57
  var tmp58
  var tmp59
  var tmp60
  var tmp61
  var tmp62
  var tmp63
  var tmp64
//
  // __patsflab_player_move
  tmp48 = ats2jspre_eq_double_double(arg0, 0.0);
  if(tmp48) {
    tmp49 = player_getPosition_Y();
    tmp52 = ats2jspre_add_double_double(tmp49, arg1);
    tmp51 = ats2jspre_gt_double_double(tmp52, 500.000000000000000000);
    if(tmp51) {
      tmp50 = true;
    } else {
      tmp53 = ats2jspre_add_double_double(tmp49, arg1);
      tmp54 = ats2jspre_div_double_double(18.000000000000000000, 2.0);
      tmp50 = ats2jspre_lte_double_double(tmp53, tmp54);
    } // endif
    if(tmp50) {
      // ATSINSmove_void
    } else {
      tmp55 = ats2jspre_add_double_double(tmp49, arg1);
      player_setPosition_Y(tmp55);
    } // endif
  } else {
    tmp56 = player_getPosition_X();
    tmp59 = ats2jspre_add_double_double(tmp56, arg0);
    tmp61 = ats2jspre_div_double_int(18.000000000000000000, 2);
    tmp60 = ats2jspre_sub_double_double(400.000000000000000000, tmp61);
    tmp58 = ats2jspre_gt_double_double(tmp59, tmp60);
    if(tmp58) {
      tmp57 = true;
    } else {
      tmp62 = ats2jspre_add_double_double(tmp56, arg0);
      tmp63 = ats2jspre_div_double_int(18.000000000000000000, 2);
      tmp57 = ats2jspre_lt_double_double(tmp62, tmp63);
    } // endif
    if(tmp57) {
      // ATSINSmove_void
    } else {
      tmp64 = ats2jspre_add_double_double(tmp56, arg0);
      player_setPosition_X(tmp64);
    } // endif
  } // endif
  return/*_void*/;
} // end-of-function


function
game_tick(arg0)
{
//
// knd = 0
//
  // __patsflab_game_tick
  enemy_update(arg0);
  score_update(arg0);
  player_update(arg0);
  return/*_void*/;
} // end-of-function


function
player_update(arg0)
{
//
// knd = 0
//
  // __patsflab_player_update
  player_keyPress();
  return/*_void*/;
} // end-of-function


function
enemy_update(arg0)
{
//
// knd = 0
  var tmp70
  var tmp71
//
  // __patsflab_enemy_update
  tmp70 = enemy_get(arg0);
  // ATScaseofseq_beg
  tmplab_js = 1;
  while(true) {
    tmplab = tmplab_js; tmplab_js = 0;
    switch(tmplab) {
      // ATSbranchseq_beg
      case 1: // __atstmplab0
      if(ATSCKptriscons(tmp70)) { tmplab_js = 4; break; }
      case 2: // __atstmplab1
      // ATSINSmove_void
      break;
      // ATSbranchseq_end
      // ATSbranchseq_beg
      case 3: // __atstmplab2
      if(ATSCKptrisnull(tmp70)) ATSINScaseof_fail("/home/grad3/gladius/CS520/hwtest/SpaceInvaders/myGame.dats: 2719(line=126, offs=3) -- 2863(line=133, offs=6)");
      case 4: // __atstmplab3
      tmp71 = create_enemy();
      set_enemy_animation(tmp71);
      break;
      // ATSbranchseq_end
    } // end-of-switch
    if (tmplab_js === 0) break;
  } // endwhile
  // ATScaseofseq_end
  return/*_void*/;
} // end-of-function


function
set_enemy_animation(arg0)
{
//
// knd = 0
  var tmp73
  var tmp74
  var tmp75
  var tmp76
  var tmp77
  var tmp78
  var tmp79
  var tmp80
//
  // __patsflab_set_enemy_animation
  tmp73 = player_getPosition_X();
  tmp74 = player_getPosition_Y();
  tmp75 = enemy_getPosition_X(arg0);
  tmp76 = enemy_getPosition_Y(arg0);
  tmp77 = ats2jspre_sub_double_double(tmp73, tmp75);
  tmp78 = ats2jspre_sub_double_double(tmp74, tmp76);
  tmp79 = ats2jspre_div_double_double(tmp77, tmp78);
  tmp80 = ats2jspre_gt_double_double(tmp79, 5.0);
  if(tmp80) {
    enemy_move(arg0, 5.0, 1.0, __patsfun_10__closurerize(arg0));
  } else {
    enemy_move(arg0, tmp79, 1.0, __patsfun_11__closurerize(arg0));
  } // endif
  return/*_void*/;
} // end-of-function


function
__patsfun_10(env0)
{
//
// knd = 0
//
  // __patsflab___patsfun_10
  player_crash(env0);
  return/*_void*/;
} // end-of-function


function
__patsfun_11(env0)
{
//
// knd = 0
//
  // __patsflab___patsfun_11
  player_crash(env0);
  return/*_void*/;
} // end-of-function


function
player_crash(arg0)
{
//
// knd = 0
  var tmp85
//
  // __patsflab_player_crash
  enemy_remove(arg0);
  tmp85 = _057_home_057_grad3_057_gladius_057_CS520_057_hwtest_057_SpaceInvaders_057_myGame_056_sats__player_get();
  // ATScaseofseq_beg
  tmplab_js = 1;
  while(true) {
    tmplab = tmplab_js; tmplab_js = 0;
    switch(tmplab) {
      // ATSbranchseq_beg
      case 1: // __atstmplab4
      if(ATSCKptriscons(tmp85)) { tmplab_js = 4; break; }
      case 2: // __atstmplab5
      // ATSINSmove_void
      break;
      // ATSbranchseq_end
      // ATSbranchseq_beg
      case 3: // __atstmplab6
      if(ATSCKptrisnull(tmp85)) ATSINScaseof_fail("/home/grad3/gladius/CS520/hwtest/SpaceInvaders/myGame.dats: 3536(line=159, offs=3) -- 3627(line=161, offs=18)");
      case 4: // __atstmplab7
      // ATSINSmove_void
      break;
      // ATSbranchseq_end
    } // end-of-switch
    if (tmplab_js === 0) break;
  } // endwhile
  // ATScaseofseq_end
  return/*_void*/;
} // end-of-function


function
enemy_move(arg0, arg1, arg2, arg3)
{
//
// knd = 0
  var tmp87
  var tmp88
  var tmp89
  var tmp90
  var tmp92
  var tmp93
//
  // __patsflab_enemy_move
  tmp87 = enemy_getPosition_X(arg0);
  tmp88 = enemy_getPosition_Y(arg0);
  tmp89 = ats2jspre_add_double_double(tmp87, arg1);
  tmp90 = ats2jspre_add_double_double(tmp88, arg2);
  enemy_setPosition(arg0, tmp89, tmp90);
  tmp92 = enemy_check_crash(arg0, tmp89, tmp90);
  // ATScaseofseq_beg
  tmplab_js = 1;
  while(true) {
    tmplab = tmplab_js; tmplab_js = 0;
    switch(tmplab) {
      // ATSbranchseq_beg
      case 1: // __atstmplab8
      if(!ATSCKpat_int(tmp92, 1)) { tmplab_js = 3; break; }
      case 2: // __atstmplab9
      arg3[0](arg3);
      break;
      // ATSbranchseq_end
      // ATSbranchseq_beg
      case 3: // __atstmplab10
      if(!ATSCKpat_int(tmp92, 0)) ATSINScaseof_fail("/home/grad3/gladius/CS520/hwtest/SpaceInvaders/myGame.dats: 3971(line=173, offs=3) -- 4265(line=181, offs=6)");
      case 4: // __atstmplab11
      tmp93 = enemy_check_bound(arg0, tmp89, tmp90);
      // ATScaseofseq_beg
      tmplab_js = 1;
      while(true) {
        tmplab = tmplab_js; tmplab_js = 0;
        switch(tmplab) {
          // ATSbranchseq_beg
          case 1: // __atstmplab12
          if(!ATSCKpat_int(tmp93, 1)) { tmplab_js = 3; break; }
          case 2: // __atstmplab13
          enemy_remove(arg0);
          break;
          // ATSbranchseq_end
          // ATSbranchseq_beg
          case 3: // __atstmplab14
          if(!ATSCKpat_int(tmp93, 0)) ATSINScaseof_fail("/home/grad3/gladius/CS520/hwtest/SpaceInvaders/myGame.dats: 4110(line=178, offs=5) -- 4253(line=180, offs=85)");
          case 4: // __atstmplab15
          setTimeout_cloref(__patsfun_14__closurerize(arg0, arg1, arg2, arg3), 5.0);
          break;
          // ATSbranchseq_end
        } // end-of-switch
        if (tmplab_js === 0) break;
      } // endwhile
      // ATScaseofseq_end
      break;
      // ATSbranchseq_end
    } // end-of-switch
    if (tmplab_js === 0) break;
  } // endwhile
  // ATScaseofseq_end
  return/*_void*/;
} // end-of-function


function
__patsfun_14(env0, env1, env2, env3)
{
//
// knd = 0
//
  // __patsflab___patsfun_14
  enemy_move(env0, env1, env2, env3);
  return/*_void*/;
} // end-of-function


function
enemy_check_crash(arg0, arg1, arg2)
{
//
// knd = 0
  var tmpret95
  var tmp96
  var tmp97
  var tmp98
  var tmp99
  var tmp100
  var tmp101
  var tmp102
  var tmp103
//
  // __patsflab_enemy_check_crash
  tmp96 = player_getPosition_X();
  tmp97 = player_getPosition_Y();
  tmp98 = enemy_getPosition_X(arg0);
  tmp99 = enemy_getPosition_Y(arg0);
  tmp100 = calc_dist(tmp96, tmp97, tmp98, tmp99);
  tmp102 = ats2jspre_add_double_double(18.000000000000000000, 18.000000000000000000);
  tmp101 = ats2jspre_div_double_double(tmp102, 2.0);
  tmp103 = ats2jspre_lt_double_double(tmp100, tmp101);
  if(tmp103) {
    crash_report(tmp96, tmp97, tmp98, tmp99);
    tmpret95 = 1;
  } else {
    tmpret95 = 0;
  } // endif
  return tmpret95;
} // end-of-function


function
enemy_check_bound(arg0, arg1, arg2)
{
//
// knd = 0
  var tmpret105
  var tmp106
  var tmp107
  var tmp108
  var tmp109
//
  // __patsflab_enemy_check_bound
  tmp109 = ats2jspre_gt_double_double(arg1, 400.000000000000000000);
  if(tmp109) {
    tmp108 = true;
  } else {
    tmp108 = ats2jspre_lt_double_double(arg1, 0.0);
  } // endif
  if(tmp108) {
    tmp107 = true;
  } else {
    tmp107 = ats2jspre_gt_double_double(arg2, 500.000000000000000000);
  } // endif
  if(tmp107) {
    tmp106 = true;
  } else {
    tmp106 = ats2jspre_lt_double_double(arg2, 0.0);
  } // endif
  if(tmp106) {
    tmpret105 = 1;
  } else {
    tmpret105 = 0;
  } // endif
  return tmpret105;
} // end-of-function


function
cloref_app(arg0)
{
//
// knd = 0
//
  // __patsflab_cloref_app
  arg0[0](arg0);
  return/*_void*/;
} // end-of-function

// dynloadflag_init
var _057_home_057_grad3_057_gladius_057_CS520_057_hwtest_057_SpaceInvaders_057_myGame_056_dats__dynloadflag = 0;

function
_057_home_057_grad3_057_gladius_057_CS520_057_hwtest_057_SpaceInvaders_057_myGame_056_dats__dynload()
{
//
// knd = 0
//
  // ATSdynload()
  // ATSdynloadflag_sta(_057_home_057_grad3_057_gladius_057_CS520_057_hwtest_057_SpaceInvaders_057_myGame_056_dats__dynloadflag(231))
  if(ATSCKiseqz(_057_home_057_grad3_057_gladius_057_CS520_057_hwtest_057_SpaceInvaders_057_myGame_056_dats__dynloadflag)) {
    _057_home_057_grad3_057_gladius_057_CS520_057_hwtest_057_SpaceInvaders_057_myGame_056_dats__dynloadflag = 1 ; // flag is set
    statmp0 = ats2jspre_ref(3);
    statmp1 = ats2jspre_ref(0);
    statmp2 = ats2jspre_ref(200);
    statmp3 = ats2jspre_ref(10);
  } // endif
  return/*_void*/;
} // end-of-function


function
my_dynload()
{
//
// knd = 0
//
  _057_home_057_grad3_057_gladius_057_CS520_057_hwtest_057_SpaceInvaders_057_myGame_056_dats__dynload();
  return/*_void*/;
} // end-of-function


/* ATSextcode_beg() */
function
ATS_start()
{
  var _ = my_dynload();
  var _ = init();
}

function
test(x, y, z, a){
  console.log("player:" + x + ", " + y + "; enemy:" + z + ", " + a);
}

function
crash_report(x, y, z, a){
  console.log("crash found => player:" + x + ", " + y + "; enemy:" + z + ", " + a);
}

function
setTimeout_cloref(fwork, ntime)
{
  setTimeout(function(){cloref_app(fwork);return;}, ntime);
}
/* ATSextcode_end() */

/* ****** ****** */

/* end-of-compilation-unit */
